{"version":3,"sources":["Resources/Private/Assets/Backend/ButtonContextBar.js","Resources/Private/Assets/Backend.js","Resources/Private/Assets/Backend/NeosEvents.js"],"names":["IS_NEW_UI","window","name","SITE_DOC","document","NEOS_DOC","parent","NAMESPACE","ICONS_BASE","ICONS","element","settings","activeHref","recallSetElement","callback","setElement","querySelector","parentElement","getElementById","error","setButtonState","button","state","body","classList","contains","toggleClass","style","background","addButton","className","title","createElement","type","assign","onmouseover","onmouseout","onclick","blur","innerHTML","icon","insertBefore","firstChild","add","onunload","location","href","removeChild","buttonCallback","triggerButton","toggle","removeButton","log","remove","Carbon","options","Object","check","events","count","replace","split","Array","isArray","length","forEach","addEventListener","nameOfEvent"],"mappings":";;;;;yBAAA,IAAMA,IAA8B,qBAAfC,OAAOC,MACtBC,EAAWF,OAAOG,SAClBC,EAAWL,EAAYC,OAAOK,OAAOF,SAAWD,EAChDI,EAAY,2BACZC,8HACAC,kBACcD,ogBACEA,sRACFA,4YACAA,qYAGhBE,EAAU,KACVC,EAAW,KACXC,EAAa,KAWjB,SAASC,EAAiBC,cACX,aACIA,IACZ,KAGP,SAASC,EAAWD,OAERd,IACUK,EAASW,cAAc,wBAC5BC,cAbNZ,EAASa,eAAe,sBAebb,EAASW,cAAc,mCAEhBF,GAEvB,MAAOK,KACYL,WAEbJ,GAA8B,mBAAZI,cACPA,EAAU,MAKjC,SAASM,EACLC,OACAC,yDAAQnB,EAASoB,KAAKC,UAAUC,SAASd,EAASe,aAE9CL,MACOM,MAAMC,WAAaN,EAAQ,UAAY,eAItD,SAASO,QAEAxB,EAASW,wBACIT,MAAaI,EAASmB,oBAAmBnB,EAASoB,WAElE,KACMV,EAAShB,EAAS2B,cAAc,UAChB7B,EAASoB,KAAKC,YAC3BM,UAAevB,MAAaI,EAASmB,YACrCG,KAAO,WACPF,MAAQpB,EAASoB,aACjBG,OAAOb,EAAOM,gBACP,mBACD,aACF,eACE,sBACD,gBACE,eACD,SACD,gBACO,YACR,aACA,cACC,qBACI,mBACN,wDACS,gCACW,wCACC,gBAExBQ,YAAc,aACFd,GAAQ,MAEpBe,WAAa,aACDf,MAEZgB,QAAU,aACNC,SACOjB,MAEXkB,UACH5B,EAAS6B,QAAQ/B,EAAQA,EAAME,EAAS6B,MAAQ7B,EAAS6B,OACrDC,aAAapB,EAAQX,EAAQgC,YAEjCrC,EAASE,GAAWI,EAASe,iBAEpBH,KAAKC,UAAUmB,IAAIhC,EAASe,eACtBL,GAAQ,WAEpBuB,SAAW,WACVhC,GAAciC,SAASC,OACVzB,KAENJ,cAAc8B,YAAY1B,KAMjD,SAAS2B,EAAe3B,EAAQP,MACnBO,KAEHX,GACIA,EAAQM,kBAAkBL,EAASmB,eAGhCT,GAIjB,SAAS4B,EAAc5B,OACfG,EAAYrB,EAASoB,KAAKC,YACpB0B,OAAOvC,EAASe,eAGbmB,SAASC,OACbvC,GAAWI,EAASe,aAAeF,EAAUC,SAClDd,EAASe,eAGEL,EAAQD,GAG3B,SAAS+B,EAAa9B,KACHA,EAAQ,oBACX+B,IAAI/B,KACLJ,cAAc8B,YAAY1B,OAG5BE,KAAKC,UAAU6B,OAAO1C,EAASe,eAC/BnB,GAAWI,EAASe,cAAe,OApId,IAAvBrB,EAASE,OACPA,OChBQ,mBAAV+C,gBACA,wBDsJF,YAEGC,EAAQzB,WACRyB,EAAQf,MACRe,EAAQxB,OACRwB,EAAQ7B,gBAEG8B,OAAOtB,UAAWqB,KAClB1B,YAGX,YACA0B,EAAQzB,WAAayB,EAAQ7B,gBAClB8B,OAAOtB,UAAWqB,KAClBJ,YAGX,YAEAI,EAAQzB,WACRyB,EAAQf,MACRe,EAAQxB,OACRwB,EAAQ7B,gBAEG8B,OAAOtB,UAAWqB,GACD,mBAAjBA,EAAQE,UACNA,MAAQF,EAAQE,WAEhB9C,EAAS8C,MAAQ5B,EAAYsB,aAGzC,YACDI,EAAQzB,WAAayB,EAAQ7B,gBAClB6B,IACAN,cCvLZ,aCJI,SAASS,EAAQ5C,OAExB6C,EAAQ,QACU,iBAAXD,MACEA,EAAOE,QAAQ,MAAO,IAAIC,MAAM,MAGzCC,MAAMC,QAAQL,IAA+B,mBAAb5C,MACxB4C,EAAOM,SACRC,QAAQ,qBACFC,iBAAiB,QAAUC,EAAarD,GAAU,MAI5D6C,EAAQ,eAA2B,IAAVA,EAAc,GAAK,KAAO","file":"Backend.js","sourcesContent":["const IS_NEW_UI = !!(window.name == \"neos-content-main\");\nconst SITE_DOC = window.document;\nconst NEOS_DOC = IS_NEW_UI ? window.parent.document : SITE_DOC;\nconst NAMESPACE = \"__carbonbuttoncontextbar\";\nconst ICONS_BASE = `style=\"fill:#fff\" class=\"neos-svg-inline--fa neos-fa-image fa-w-18\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\"`;\nconst ICONS = {\n    images: `<svg ${ICONS_BASE} viewBox=\"0 0 576 512\"><path d=\"M480 416v16c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V176c0-26.51 21.49-48 48-48h16v208c0 44.112 35.888 80 80 80h336zm96-80V80c0-26.51-21.49-48-48-48H144c-26.51 0-48 21.49-48 48v256c0 26.51 21.49 48 48 48h384c26.51 0 48-21.49 48-48zM256 128c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-96 144l55.515-55.515c4.686-4.686 12.284-4.686 16.971 0L272 256l135.515-135.515c4.686-4.686 12.284-4.686 16.971 0L512 208v112H160v-48z\"/></svg>`,\n    ellipsis: `<svg ${ICONS_BASE} viewBox=\"0 0 512 512\"><path d=\"M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z\"/></svg>`,\n    arrows: `<svg ${ICONS_BASE} viewBox=\"0 0 512 512\"><path d=\"M377.941 169.941V216H134.059v-46.059c0-21.382-25.851-32.09-40.971-16.971L7.029 239.029c-9.373 9.373-9.373 24.568 0 33.941l86.059 86.059c15.119 15.119 40.971 4.411 40.971-16.971V296h243.882v46.059c0 21.382 25.851 32.09 40.971 16.971l86.059-86.059c9.373-9.373 9.373-24.568 0-33.941l-86.059-86.059c-15.119-15.12-40.971-4.412-40.971 16.97z\"/></svg>`,\n    camera: `<svg ${ICONS_BASE} viewBox=\"0 0 512 512\"><path d=\"M512 144v288c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V144c0-26.5 21.5-48 48-48h88l12.3-32.9c7-18.7 24.9-31.1 44.9-31.1h125.5c20 0 37.9 12.4 44.9 31.1L376 96h88c26.5 0 48 21.5 48 48zM376 288c0-66.2-53.8-120-120-120s-120 53.8-120 120 53.8 120 120 120 120-53.8 120-120zm-32 0c0 48.5-39.5 88-88 88s-88-39.5-88-88 39.5-88 88-88 88 39.5 88 88z\"/></svg>`\n};\n\nlet element = null;\nlet settings = null;\nlet activeHref = null;\n\n// Prepare to save the state\nif (typeof NEOS_DOC[NAMESPACE] == \"undefined\") {\n    NEOS_DOC[NAMESPACE] = {};\n}\n\nfunction oldUiIsLoaded() {\n    return NEOS_DOC.getElementById(\"neos-context-bar\");\n}\n\nfunction recallSetElement(callback) {\n    setTimeout(() => {\n        setElement(callback);\n    }, 100);\n}\n\nfunction setElement(callback) {\n    try {\n        if (IS_NEW_UI) {\n            element = NEOS_DOC.querySelector(\"[target=neosPreview]\")\n                .parentElement;\n        } else if (oldUiIsLoaded()) {\n            element = NEOS_DOC.querySelector(\"#neos-context-bar>.neos-right\");\n        } else {\n            recallSetElement(callback);\n        }\n    } catch (error) {\n        recallSetElement(callback);\n    } finally {\n        if (element && typeof callback == \"function\") {\n            setTimeout(callback, 100);\n        }\n    }\n}\n\nfunction setButtonState(\n    button,\n    state = SITE_DOC.body.classList.contains(settings.toggleClass)\n) {\n    if (button) {\n        button.style.background = state ? \"#00adee\" : \"transparent\";\n    }\n}\n\nfunction addButton() {\n    if (\n        !NEOS_DOC.querySelector(\n            `button.${NAMESPACE}.${settings.className}[title=${settings.title}]`\n        )\n    ) {\n        let button = NEOS_DOC.createElement(\"button\");\n        let bodyClassList = SITE_DOC.body.classList;\n        button.className = `${NAMESPACE} ${settings.className}`;\n        button.type = \"button\";\n        button.title = settings.title;\n        Object.assign(button.style, {\n            position: \"relative\",\n            outline: \"none\",\n            float: \"left\",\n            display: \"inline-block\",\n            height: \"40px\",\n            minWidth: \"40px\",\n            padding: 0,\n            border: 0,\n            verticalAlign: \"top\",\n            width: \"40px\",\n            color: \"#fff\",\n            cursor: \"pointer\",\n            background: \"transparent\",\n            font: \"normal normal normal 14px/1 FontAwesome\",\n            textRendering: \"auto\",\n            \"-webkit-font-smoothing\": \"antialiased\",\n            \"-moz-osx-font-smoothing\": \"grayscale\"\n        });\n        button.onmouseover = () => {\n            setButtonState(button, true);\n        };\n        button.onmouseout = () => {\n            setButtonState(button);\n        };\n        button.onclick = () => {\n            button.blur();\n            triggerButton(button);\n        };\n        button.innerHTML =\n            settings.icon in ICONS ? ICONS[settings.icon] : settings.icon;\n        element.insertBefore(button, element.firstChild);\n\n        if (NEOS_DOC[NAMESPACE][settings.toggleClass]) {\n            // Set active state\n            SITE_DOC.body.classList.add(settings.toggleClass);\n            setButtonState(button, true);\n        }\n        window.onunload = () => {\n            if (activeHref != location.href) {\n                removeButton(button);\n            } else {\n                button.parentElement.removeChild(button);\n            }\n        };\n    }\n}\n\nfunction buttonCallback(button, callback) {\n    button = button\n        ? button\n        : element\n            ? element.querySelector(`.${settings.className}`)\n            : false;\n    if (button) {\n        callback(button);\n    }\n}\n\nfunction triggerButton(button) {\n    let classList = SITE_DOC.body.classList;\n    classList.toggle(settings.toggleClass);\n\n    // Save the state\n    activeHref = location.href;\n    NEOS_DOC[NAMESPACE][settings.toggleClass] = classList.contains(\n        settings.toggleClass\n    );\n\n    buttonCallback(button, setButtonState);\n}\n\nfunction removeButton(button) {\n    buttonCallback(button, button => {\n        console.log(button);\n        button.parentElement.removeChild(button);\n    });\n\n    SITE_DOC.body.classList.remove(settings.toggleClass);\n    NEOS_DOC[NAMESPACE][settings.toggleClass] = false;\n}\n\nconst ButtonContextBar = {\n    add: options => {\n        if (\n            options.className &&\n            options.icon &&\n            options.title &&\n            options.toggleClass\n        ) {\n            settings = Object.assign({}, options);\n            setElement(addButton);\n        }\n    },\n    remove: options => {\n        if (options.className && options.toggleClass) {\n            settings = Object.assign({}, options);\n            setElement(removeButton);\n        }\n    },\n    toggle: options => {\n        if (\n            options.className &&\n            options.icon &&\n            options.title &&\n            options.toggleClass\n        ) {\n            settings = Object.assign({}, options);\n            if (typeof options.check == \"function\") {\n                settings.check = options.check();\n            }\n            setElement(!!settings.check ? addButton : removeButton);\n        }\n    },\n    trigger: options => {\n        if (options.className && options.toggleClass) {\n            settings = options;\n            setElement(triggerButton);\n        }\n    }\n};\n\nexport default ButtonContextBar;\n","import { NeosEvents, ButtonContextBar } from \"./Backend/index.js\";\n\nif (typeof Carbon == \"function\") {\n    Carbon(\"ButtonContextBar\", ButtonContextBar);\n    Carbon(\"NeosEvents\", NeosEvents);\n}\n","export default function(events, callback) {\n    // http://neos.readthedocs.io/en/stable/ExtendingNeos/InteractionWithTheNeosBackend.html\n    let count = 0;\n    if (typeof events === \"string\") {\n        events = events.replace(/\\s/g, \"\").split(\",\");\n    }\n\n    if (Array.isArray(events) && typeof callback === \"function\") {\n        count = events.length;\n        events.forEach(nameOfEvent => {\n            document.addEventListener(\"Neos.\" + nameOfEvent, callback, false);\n        });\n    }\n\n    return count + \" Neos Event\" + (count === 1 ? \"\" : \"s\") + \" added.\";\n}\n"]}